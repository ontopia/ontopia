<?xml version="1.0" encoding="ISO-8859-1"?>
<!--DOCTYPE article PUBLIC "-//OASIS//DTD DocBook XML V4.1//EN" ""-->
<!-- $Id: viz_userguide.xml,v 1.58 2008/06/13 12:06:19 geir.gronmo Exp $ -->
<article> 
  <title>The Ontopia Vizigator&#x2122;</title> 
  <subtitle>User's Guide</subtitle>
  <!-- markup conventions:
     terms like "Welcome Page": first occurrence <firstterm>, thereafter just capitalisation
     filenames, directory names: <filename>
     button names: <emphasis role="bold">
     syntax: <symbol>
-->
<!--Additions for future: localization support; up/down arrows affect spinner - 
other keystrokes affect search box; load config menu item; -->
  <articleinfo> 
    <author> 
      <affiliation><orgname>Ontopia</orgname> 
      </affiliation> 
    </author> 
    <pubdate>$Date: 2008/06/13 12:06:19 $</pubdate> 
    <releaseinfo>4.0 ($Revision: 1.58 $) </releaseinfo> 
    <abstract> 
      <!--The documentation must be updated to describe the support
           for scope filtering of associations. The localization
           support could perhaps also receive more mention.-->
      <para> This document introduces the reader to Vizigator. It provides
        guidance on the use of Vizigator to: 
        <itemizedlist> 
          <listitem> 
            <para>visualize and navigate topic maps;</para> 
          </listitem> 
          <listitem> 
            <para>customize the visualization characteristics of a topic map
              for an application; and </para> 
          </listitem> 
          <listitem> 
            <para>embed a visualization window in web applications built using
              the OKS.</para> 
          </listitem> 
        </itemizedlist></para> 
      <para>Reading this document assumes some basic knowledge about topic
        maps. If you are not familiar with topic maps, try reading one of the simple
        introductions, such as 
        <ulink url="http://www.ontopia.net/topicmaps/materials/tao.html">The
          TAO of Topic Maps</ulink>, available from the Ontopia web site. If you are
        technically minded, you might also want to look at the 
        <ulink url="http://www.topicmaps.org/xtm/1.0/">XTM
          Specification</ulink> or the latest drafts of the new version of ISO 13250,
        especially the 
        <ulink url="http://www.isotopicmaps.org/sam/sam-model/">Data
          Model</ulink>.</para> 
      <para> We welcome any suggestions you might have on ways of improving
        this User Guide. Please send them to 
        <email>dev@ontopia.net</email>.</para> 
      <para>Happy Vizigating! </para> 
    </abstract> 
  </articleinfo> 

<section> 
    <title>Introduction</title> 
    <para>The Topic Maps model describes the knowledge structures inherent in
      an underlying body of information. This model, which reflects the associative
      mode typical of the way humans think, can then be intuitively perused in
      different ways. </para> 
    <para>One possibility is a text-based interface. The Ontopia Omnigator (the
      name is a contraction of "omnivorous navigator") uses a form-based navigation
      paradigm that is commonly known and used by most of us every day when using the
      web. </para> 
    <para>However, often a picture or graphic can be easier to grasp than a
      wordy description. The Ontopia Vizigator ("vi[z]ual navigator") uses a
      graphical interface to provide an additional method of topic map navigation.
      Although Vizigator can be used on its own, it is also well-suited to complement
      a text-based interface.</para> 
    <section> 
      <title>Components</title> 
      <para> Vizigator consists of three components which are related/dependent
        on each other. 
        <itemizedlist> 
          <listitem> 
            <para><emphasis role="bold">VizDesktop&#x2122;</emphasis> -
              designer's configuration tool</para> 
            <para> Licensing: Available in all Developer and Runtime License
              editions. </para> 
            <para> VizDesktop can be used without any other OKS browsing
              environment. However, it is primarily a configuration tool for application
              designers to determine whether and/or how various topic types and associations
              will be graphically displayed. This is the entry point to the entire Ontopia
              Vizigator. To get started, see <xref linkend="vd01"/></para> 
          </listitem> 
          <listitem> 
            <para><emphasis role="bold">VizLet&#x2122;</emphasis> - reusable
              applet component</para> 
            <para> Licensing: Available in all Developer and Runtime License
              editions. </para> 
            <para> All of the visualization capability of VizDesktop, but
              without the configuration toolkit, VizLet can be used within other web
              applications. To bring topic map visualization to any web site, see
              <xref linkend="vl01"/></para> 
          </listitem> 
          <listitem> 
            <para><emphasis role="bold">VizPlugin&#x2122;</emphasis> -
              Omnigator plug-in</para> 
            <para> Licensing: Available within OKS Samplers and in all
              Developer and Runtime License editions. </para> 
            <para> Based on VizLet, VizPlugin can be used to visualize any
              topic currently under view in Omnigator. To find out more about navigating
              visually in Omnigator, see <xref linkend="vp01"/></para> 
          </listitem> 
        </itemizedlist></para> 

        <para>Vizigator uses TouchGraph, an open source toolkit for
        graph visualization, which is maintained as a Sourceforge
        project. For further information, please see the <ulink
        url="http://touchgraph.sourceforge.net/discuss.html">Sourceforge
        project homepage</ulink> and the <ulink
        url="http://www.touchgraph.com/index.html">TouchGraph
        homepage</ulink> with other example applications.</para>
    </section> 
    <section id="scope"> 
      <title>Scope of Use</title> 
      <para>Vizigator is designed for graphically browsing and navigating topic
        maps. It supports all aspects of ISO 13250 with the exception of merging and
        some aspects of scope. It accepts topic maps in a variety of serialization
        syntaxes. </para> 
      <para>Vizigator is used to visualize a topic map, not an ontology. That
        is, Vizigator is designed to help users understand, navigate, and browse a
        populated topic map via a graphical interface.</para> 
      <note> 
        <para>It is possible to visualize an ontology using Vizigator; however,
          it requires modifications to the topic map. One way to accomplish this is to
          create a topic type, such as 'ontology_topic' and make all typing topics an
          instance of that type.</para> 
      </note> 
      <para>Creating and editing topic maps via Vizigator is not supported at
        this time.</para> 
    </section> 
    <section id="locsupport"> 
      <title>Localization Support</title> 
      <para> Vizigator has internationalization support for translating the
        user interface into any language. The following table lists the currently
        supported languages and the codes that should be used to designate their use
        (see <xref linkend="startvizdesktop"/> and <xref linkend="usevizlet"/>).
        Additional languages will be added over time. </para> 
      <table> 
      <title>Interface localizations</title> 
      <tgroup cols="3"><colspec colnum="1" colname="one"
        colwidth="*2"/><colspec colnum="2" colname="two"
        colwidth="*1"/><colspec colnum="3" colname="three" colwidth="*3"/> 
        <thead> 
          <row><entry>Language</entry><entry>Code</entry><entry>Translation
              Acknowledgements</entry> 
          </row> 
        </thead> 
        <tbody> 
          <row><entry>English</entry><entry>en</entry><entry>- </entry> 
          </row> 
          <row><entry>Japanese</entry><entry>ja</entry><entry>Thank you to
              Motomu Naito, CEO of partner 
              <ulink url="http://www.knowledge-synergy.com/">Knowledge 
              Synergy</ulink>, Inc., Japan
            </entry> 
          </row> 
          <row><entry>German</entry><entry>de</entry><entry>Thank you to Ingo
              Schönfeld, Knowledge Engineer at ATLAS Elektronik GmbH, Germany</entry> 
          </row> 
          <row><entry>Norwegian</entry><entry>no</entry><entry>- </entry> 
          </row> 
        </tbody> 
      </tgroup> 
      </table> 
      <note> 
        <para>Users interested in translating the interface to an unsupported
          language should contact Ontopia at 
          <email>dev@ontopia.net</email> .</para> 
      </note> 
    </section> 
  </section>
 
  <section id="vd01"> 
    <title>VizDesktop&#x2122; - Getting started with Vizigator</title> 

      <para>VizDesktop provides: 
        <itemizedlist> 
          <listitem> 
            <para>a simple graphical topic map browser;</para> 
          </listitem> 
          <listitem> 
            <para>tools to configure views for Omnigator (VizPlugin) or your
              own application (VizLet).</para> 
          </listitem> 
        </itemizedlist></para> 
      <note> 
        <para>The VizDesktop application is developed using the GUI toolkit
          (Java Foundation Classes(JFC)/Swing) provided with Java platform 2 standard
          edition (J2SE). The general look and feel of the user interface is according to
          the Java&#x2122; Swing controls in order to run on both Windows and Unix/Linux
          clients.</para> 
      </note> 

    <section id="startvizdesktop"> 
      <title>Starting VizDesktop</title> 
      <para><emphasis role="bold">Prerequisites:</emphasis> VizDesktop
      is a Java application and requires the Java Developer Kit (JDK),
      Standard Edition Version 1.3 (or higher).</para>
      
      <para>Starting VizDesktop: 
        <orderedlist> 
          <listitem> 
            <para><emphasis role="bold">On Windows</emphasis> execute the
              <filename>vizdesktop.bat</filename> file in
              <filename>${OKS_HOME}\bin</filename>.</para> 
          </listitem> 
          <listitem> 
            <para><emphasis role="bold">On UNIX/Linux</emphasis> execute the
              <filename>vizdesktop.sh</filename> file in
              <filename>${OKS_HOME}/bin</filename>.</para> 
          </listitem> 
        </orderedlist></para> 
      <para> To set the language used in the VizDesktop interface, you can edit
        the command line in the 
        <command>.bat</command> or 
        <command>.sh</command> file with the parameter 
        <command>--lang=&lt;lang&gt;</command> where 
        <command>&lt;lang&gt;</command> is a two-character designation of the
        language to be used. (See <xref linkend="locsupport"/> for the list of
        supported languages.) Alternatively, you can add the parameter when invoking
        the batch files: 
        <orderedlist> 
          <listitem> 
            <para><emphasis role="bold">On Windows</emphasis>: 
              <command>vizdesktop --lang=&lt;lang&gt;</command></para> 
          </listitem> 
          <listitem> 
            <para><emphasis role="bold">On UNIX/Linux</emphasis>: 
              <command>vizdesktop.sh --lang=&lt;lang&gt;</command></para> 
          </listitem> 
        </orderedlist></para> 
      <para>Please send all comments to 
        <email>support@ontopia.net</email>. Bugs can be reported in 
        <ulink url="http://www.ontopia.net/bugs/">the bug
          database</ulink>.</para> 
    </section> 
    <section> 
      <title>The user interface</title> 
      <para></para> 
      <section> 
        <title>Primary graphical conventions</title> 
        <para>Conventions for visualization of topic map constructs are as
          follows: 
          <itemizedlist> 
            <listitem> 
              <para><emphasis role="bold">Topics</emphasis> appear as nodes
                with a topic name. Other names by which the topic is known are available via the
                <firstterm>Properties box</firstterm> accessible via the context menu (right
                click on the topic). </para> 
              <para> Alternatively, all topic names in a given scope can be
                displayed by choosing a scoping topic from the 
                <command>Name Scoping</command> menu item. If a topic does not
                have a name within a chosen scope, the <firstterm>unconstrained
                scope</firstterm> topic name is used.</para> 
              <para>The algorithm for determining which topic name to display in
                the unconstrained scope is as follows: 
                <itemizedlist> 
                  <listitem> 
                    <para>use an unscoped name (randomly selected if more than
                      1), </para> 
                  </listitem> 
                  <listitem> 
                    <para>else, use a scoped name (randomly selected if more
                      than 1).</para> 
                  </listitem> 
                </itemizedlist> </para> 
              <para> 
                <note> 
                  <para>Very long topic names will be shortened
                    algorithmically to aid visualization. Shortened names will end in '...' and
                    holding the mouse over the node will cause the name to expand.</para> 
                </note> </para> 
            </listitem> 
            <listitem> 
              <para><emphasis role="bold">Topic Types</emphasis> are
                distinguishable based on the shape, color, and other style characteristics
                applied to the node. The name of the type is available on the Properties
                box.</para> 
            </listitem> 
            <listitem> 
              <para><emphasis role="bold">Associations</emphasis> between
                topics are shown as edges (lines). Association types are distinguishable based
                on the shape and color of the edge. Association types and role names are
                visible during mouse-over; role names may be optionally suppressed.</para> 
              <para> By default, all associations in all scopes are displayed.
                It is possible to filter associations by scope using the <emphasis>Association
                Scoping</emphasis> menu item (see <xref linkend="assoc_scope"/>).</para> 
            </listitem> 
            <listitem> 
              <para><emphasis role="bold">Occurrences</emphasis>, grouped by
                type, are viewable via the Properties box. 
                <note> 
                  <para>It is not possible to navigate to the occurrences in
                    VizDesktop, only in VizLet and VizPlugin.</para> 
                </note></para> 
            </listitem> 
          </itemizedlist></para> 
        <para>If no predefined configuration is associated with a topic map,
          each type of topic and each type of association is automatically and randomly
          assigned a color each time the topic map is opened. These colors can be changed
          and saved in a configuration for the specific topic map. </para> 
      </section>
      <section>
        <title>Viewing principles</title> 
        <para>For the purposes of this section, we will ignore the fact that
          the graph in Vizigator represents a topic map, and instead focus on the graph
          and what happens to it. This means that in general, a node is considered to be
          just a node, regardless of whether it represents a topic or an association.
          </para>
        <para> The graph available through Vizigator is best seen as divided
          into three sets: </para> 
        <itemizedlist> 
          <listitem> 
            <formalpara> 
              <title>The complete graph</title> 
              <para>This is the entire, unfiltered graph where every topic and
                association in the topic map have corresponding nodes and edges.</para> 
            </formalpara> 
          </listitem> 
          <listitem> 
            <formalpara> 
              <title>The filtered graph</title> 
              <para>This is the graph as filtered by the type and scope filter
                settings.</para> 
            </formalpara> 
          </listitem> 
          <listitem> 
            <formalpara> 
              <title>The visible graph</title> 
              <para>This is the graph that is actually shown in the Vizigator
                screen (including parts that may be scrolled off outside the rectangle
                currently being shown).</para> 
            </formalpara> 
          </listitem> 
        </itemizedlist> 
        <para> The visible graph is always a subset of the filtered graph
          (though not necessarily a true subset), and the filtered graph is always a
          subset of the complete graph (though again not necessarily a true subset). The
          filter settings determine what's in the filtered graph, but determining what is
          in the visible graph is more complex. There are two views or modes of operation
          for the visible graph: </para> 
        <itemizedlist> 
          <listitem> 
            <formalpara> 
              <title>Map View</title> 
              <para>In <firstterm>Map View</firstterm> the visible graph is the
                filtered graph, minus nodes and edges explicitly hidden by the user.</para> 
            </formalpara> 
          </listitem> 
          <listitem> 
            <formalpara> 
              <title>Topic View</title> 
              <para>In <firstterm>Topic View</firstterm>, that is, when there
                is a <firstterm>Focus Node</firstterm>, the visible graph is the fragment of
                the filtered graph within X steps of the Focus Node. However, the user can
                modify the visible graph by both adding and removing nodes and edges.</para> 
            </formalpara> 
            <itemizedlist> 
              <listitem> 
                <para><emphasis role="bold">Focus Node</emphasis>. The node
                  from which the locality is computed in Topic View. It is designated by double
                  clicking on a topic or by defining or using a <firstterm>Start
                  Topic</firstterm>. If in Map View at the time a Focus Node is chosen, the
                  display changes to Topic View; if in Topic View, the display refocuses on the
                  new Focus Node.</para> 
                <note> 
                  <para>The Focus Node is identified visually by a deep yellow
                    color. Use of this color in a configuration should be avoided.</para> 
                </note>
              </listitem> 
              <listitem> 
                <para><emphasis role="bold">Start Topic</emphasis>. The node
                  that is focused when the topic map is opened (if there is a pre-defined
                  configuration that includes a Start Topic). Topic View is initiated when a
                  topic is designated as the Start Topic (via the topic's context menu) or when
                  choosing to focus on a previously defined Start Topic via the 
                  <command>View\Focus Start Topic</command> menu item. Only one
                  topic can be designated as the Start Topic at any one time. Returning to Map
                  View or designating a new Focus Node does not affect the Start Topic
                  designation.</para> 
              </listitem> 
            </itemizedlist>
          </listitem> 
        </itemizedlist> 
        <para> When initially loading a topic map, dialog boxes allow
        the user to choose a Focus Node, to proceed with modelling a
        Map View, or to cancel the loading. From a Topic View, Map
        View can be can be restored via the <command>View\Map
        View</command> menu item. </para>
        <para>VizLet (and VizPlugin) and VizDesktop behave the same
        way, with the exception that VizLet always operates in topic
        view.</para>
      </section> 
      <section id="sl01"> 
        <title>Screen Layout</title> 
        <para>The VizDesktop window includes a main menu bar, three scroll
          bars, a number control, and a search box: 
          <itemizedlist> 
            <listitem> 
              <para><emphasis>VizDesktop Window</emphasis>. The file names of
                the open topic map and loaded configuration (if any) are displayed at the top
                of the VizDesktop Window.</para> 
            </listitem> 
            <listitem> 
              <para><emphasis>Menu bar</emphasis>. See <xref
                linkend="menubar"/></para> 
            </listitem> 
            <listitem> 
              <para><emphasis>Scroll bars</emphasis>. The vertical scroll bar
                at the right of the window and the horizontal scroll bar at the bottom of the
                window are used to position the graph in the viewing area, much like any other
                graphical viewer. The graph also can be repositioned by dragging the nodes
                using the mouse or by dragging the background. </para> 
            </listitem> 
            <listitem> 
              <para><emphasis>Zoom bar</emphasis>. The scroll bar at the top of
                the screen, the <firstterm role="bold">zoom bar</firstterm>, is used to zoom
                in/out of the topic map. When the thumbwheel is all the way to the left, all of
                the nodes are very close together and the lines between them will not even be
                visible. As the thumbwheel is moved to the right, the nodes spread out and the
                relationships (lines) become visible. The optimum location of the zoom bar's
                thumbwheel will vary based on the size of the topic map or the portion of the
                topic map chosen for viewing.</para> 
            </listitem> 
            <listitem> 
              <para><emphasis>Locality factor</emphasis>. To the left of the
                zoom bar is a box with an increment/decrement number control. This
                <firstterm>locality factor</firstterm> designates the maximum number of hops to
                be displayed from the Focus Node when in a Topic View. Locality factor has no
                effect on Map View. </para> 
              <para>The locality factor number can be changed by clicking on
                the arrows or by typing in a number. The maximum value accessible using the
                arrows is the maximum distance between topics within the current topic map. If
                some associations have been filtered out of the view, the number might be
                misleading because even though the locality factor is increased, the display
                won't change. </para> 
              <para>A small red box with a number (or asterisk for numbers
                higher than 9), the <firstterm>further-associations box</firstterm>, appears in
                the upper right hand corner of a topic shape when a topic has additional
                associations that are beyond the range of the locality factor. A single left
                click on the topic will display that set of associations. The display can be
                collapsed again by right clicking on the topic and choosing 
                <command>collapse node</command> from the context menu.
                Associations outside the range of the locality, or those not made to other
                topics within the locality will be removed. Those that are within the locality
                or are linked to other topics within the locality will remain.</para> 
            </listitem> 
            <listitem> 
              <para><emphasis>Search box</emphasis>. The search box is located
                just above the zoom bar at the top of the window. See <xref
                linkend="search01"/> for details on the use of the search box.</para> 
            </listitem> 
          </itemizedlist></para> 
        <figure> 
          <title> VizDesktop user interface</title><graphic
          fileref="viz_desktop_ui_description.png"/> 
        </figure> 
        <para>To hide/display the scrollbars, zoom bar, search box, and
          locality factor, right click on the background and select "Toggle Controls".
          Alternatively, only the search box can be removed from the display through use
          of the check box.</para> 
      </section> 
      <section id="menubar"> 
        <title>Menus</title> 
        <para>The main menu bar consists of the following menu items: 
          <itemizedlist> 
            <listitem> 
              <para><emphasis role="bold">File</emphasis> - menu choices
                include loading a topic map into the viewer, saving a configuration, and
                specifying an RDF mapping file. 
                <note> 
                  <para>When vizigating a topic map view of an RDF file,
                    Vizigator looks for an RDF mapping file. The default file is 
                    <command>mapping.rdff</command> and is located in
                    <filename>$TOMCAT_HOME\webapps\omnigator\WEB-INF\topicmaps</filename> (the
                    default location for the mapping file used by Omnigator). The name of the file
                    and its location may be changed or additional mapping files may be designated
                    via the 
                    <command>File\RDF mapping file</command> menu item. </para>
                  
                </note></para> 
            </listitem> 
            <listitem> 
              <para><emphasis role="bold">View</emphasis> - menu choices for
                viewing modes and focus.</para> 
            </listitem> 
            <listitem> 
              <para><emphasis role="bold">Filtering Topics</emphasis> - a
                checklist (on/off) to decide which topic types will be visible in the display.
                For further details on using filtering, see <xref linkend="filtering"/>.</para>
              
            </listitem> 
            <listitem> 
              <para><emphasis role="bold">Filtering Associations</emphasis> - a
                checklist (on/off) to decide which associations will be visible in the display.
                For further details on using filtering, see <xref linkend="filtering"/>.</para>
              
            </listitem> 
            <listitem> 
              <para><emphasis role="bold">Styling</emphasis> - menu choices for
                styling topic and association types. For further details on using Styling, see
                <xref linkend="stylingtopics"/>.</para> 
            </listitem> 
            <listitem> 
              <para><emphasis role="bold">Options</emphasis> - mechanisms for
                generally configuring the viewing environment. For further details on using
                Options, see <xref linkend="genoptions"/>.</para> 
            </listitem> 
            <listitem> 
              <para> <emphasis role="bold">Name Scoping</emphasis> - when
                defined in the topic map, a list of topics that are used to choose among a
                topic's names for the one to be displayed. For further details, see
                <xref linkend="name_scope"/></para> 
            </listitem> 
            <listitem> 
              <para> <emphasis role="bold">Association Scoping</emphasis> -
                when defined in the topic map, a set of topics that are used to filter the
                types of associations to be displayed. For further details, see
                <xref linkend="assoc_scope"/></para> 
            </listitem> 
            <listitem> 
              <para><emphasis role="bold">Help</emphasis> - information on
                Vizigator.</para> 
            </listitem> 
          </itemizedlist></para> 
        <note> 
          <para>If a menu item has been assigned a keyboard short cut, it is
            shown to the right of the item's name.</para> 
        </note> 
      </section> 
      <section> 
        <title>Loading a topic map</title> 
        <para> Vizigator recognizes all files with the extensions
          <filename>.xtm</filename>,<filename>.hytm</filename>,
          <filename>.ltm</filename>, <filename>.tmx</filename>, 
          <filename>.rdf</filename>, or
          <filename>.n3</filename>. </para> 
        <para>What to expect when loading a topic map will differ depending on
          whether or not a configuration has been saved for the topic map.</para> 
        <itemizedlist> 
          <listitem> 
            <para><emphasis role="bold">When loading a topic map for the first
              time</emphasis>, it will open in Map View or Topic View based on the user's
              choices in the 
              <command>Select initial topic</command> and follow-on dialog
              boxes. It does not load any default configuration which could reduce the
              complexity of a large topic map. </para> 
          </listitem> 
          <listitem> 
            <para><emphasis role="bold">When loading a topic map for which
              there is a configuration</emphasis>, the visualization will conform to the
              parameters of the configuration (see <xref linkend="configcomponents"/>). If a
              Start Topic was designated, it will open in Topic View; otherwise, it will open
              in Map View.</para> 
          </listitem> 
        </itemizedlist> 
        <para> Hints for achieving a sensible display of a very large topic
          map: 
          <itemizedlist> 
            <listitem> 
              <para>Setting the zoom bar furthest to the left will force the
                greatest number of topics into the viewing space; in most cases it will include
                all topics. Use the zoom bar to zoom into the topic map and choose a current
                topic by double clicking a topic. The view will change into the Topic View with
                the focus around the chosen topic and in conformance with the current locality
                factor. </para> 
            </listitem> 
            <listitem> 
              <para>Although a locality factor of 2 or 3 for a topic view may
                seem like quite a low number, in a large topic map there can still be an
                overwhelming number of topics visible. It is often easier to start with a
                locality factor of 1 and increase that as needed.</para> 
            </listitem> 
            <listitem> 
              <para>Removing the 'Instance of" association is often useful when
                the locality is set to 2 or more in a large topic map. For example, if the
                topic under consideration is 
                <command>Florence</command>, one association level away might
                be the topic 
                <command>city</command>, and two associations away would be all
                other instances of 
                <command>city</command>. Removing the 
                <command>Instance of</command> association, would remove the
                presence of all of the other topics that are instances of type 
                <command>city</command>. </para> 
            </listitem> 
            <listitem> 
              <para>To quickly find a specific topic, use the search box (see
                <xref linkend="search01"/>).</para> 
            </listitem> 
          </itemizedlist></para> 
      </section> 
      <section id="nav"> 
        <title>Navigating the graph</title> 
        <para>The following section gives a short introduction and overview of
          the default actions available using the mouse: 
          <itemizedlist> 
            <listitem> 
              <para><emphasis>left mouse button; single click on a
                topic</emphasis> - expand topic (equivalent to context menu 'Expand node'); has
                no effect on topics without a further-associations box or within Map
                View.</para> 
            </listitem> 
            <listitem> 
              <para><emphasis>left mouse button; double click on a
                topic</emphasis> - make the topic the Focus Node and the locality factor
                triggers how many related topics are displayed. </para> 
            </listitem> 
            <listitem> 
              <para><emphasis>right mouse button, click on
                background</emphasis> - displays menu items for toggling on/off the window
                controls (locality factor, zoom bar, search box, and scroll bars) as a group or
                the search box individually. </para> 
            </listitem> 
            <listitem> 
              <para><emphasis>right mouse button, click on a topic </emphasis>
                - the 
                <command>context menu</command> pops up. </para> 
              <para>The context menu displays all the actions that can be
                applied to the topic (e.g., expand, collapse, hide node, set as start node),
                provides access to the topic's Properties box (for names, types, and
                occurrences), and allows the topic to be designated as
                <firstterm>sticky</firstterm> (topic will remain positioned relative to other
                topics where specifically moved by user).</para> 
            </listitem> 
            <listitem> 
              <para><emphasis>right mouse button, click on an edge
                (association) </emphasis> - displays 
                <command>Hide edge</command> menu choice. By clicking on 
                <command>Hide edge</command>, the edge will be hidden and
                connected topics, which will be then disconnected, will also acquire a
                further-associations box (or have the number in their further-associations box
                incremented). </para> 
            </listitem> 
            <listitem> 
              <para><emphasis>mouse-over edge (association) </emphasis> -
                displays the name of the association. </para> 
            </listitem> 
          </itemizedlist></para> 
        <note> 
          <para>For changing the default mouse actions, see
            <xref linkend="genoptions"/></para> 
        </note> 
      </section> 
      <section> 
        <title>Summary of operations</title> 
        <para> This section summarizes the effects of the various operations.
          Since the effects of operations are different in the two views, each view is
          described separately. </para> 
        <section> 
          <title>Topic View</title> 
          <para> Topic View is the view where there is a Focus Node, and the
            visible graph (at least initially) contains only the nodes within a specified
            distance (the locality) of the Focus Node. Distance is computed with no regard
            to whether nodes represent topics or associations. The Focus Node is always in
            the visible graph. </para> 
          <itemizedlist> 
            <listitem> 
              <formalpara> 
                <title>Hide node</title> 
                <para>If hiding the node disconnects part of the visible graph
                  that part is removed.</para> 
              </formalpara> 
            </listitem> 
            <listitem> 
              <formalpara> 
                <title>Hide edge</title> 
                <para>If hiding the edge disconnects part of the visible graph
                  that part is removed.</para> 
              </formalpara> 
            </listitem> 
            <listitem> 
              <formalpara> 
                <title>Expand node</title> 
                <para>All nodes in the filtered graph that are neighbours of
                  the expanded node become visible together with the edges connecting them to the
                  expanded node and any edges between the newly visible nodes.</para> 
              </formalpara> 
            </listitem> 
            <listitem> 
              <formalpara> 
                <title>Collapse node</title> 
                <para>All nodes which only have edges to the collapsed node and
                  between each other are removed from the visible graph.</para> 
              </formalpara> 
            </listitem> 
            <listitem> 
              <formalpara> 
                <title>Set Focus Node</title> 
                <para>Whether done by double-clicking a node or setting the
                  Start Topic, recomputes the visible graph from the new Focus Node with the
                  existing locality setting.</para> 
              </formalpara> 
            </listitem> 
            <listitem> 
              <formalpara> 
                <title>Change locality</title> 
                <para>Recomputes the visible graph from the existing Focus Node
                  with the new locality setting. (This ignores the user's
                  expanding/collapsing/hiding modifications, but is a consistent behaviour,
                  matches the current code, and is the simplest option.)</para> 
              </formalpara> 
            </listitem> 
            <listitem> 
              <formalpara> 
                <title>Filter out</title> 
                <para>Any nodes and edges filtered out of the visible graph are
                  removed, and any parts of the graph disconnected from the Focus Node by this
                  are also removed.</para> 
              </formalpara> 
            </listitem> 
            <listitem> 
              <formalpara> 
                <title>Filter in</title> 
                <para>The topic view is recomputed, but without hiding already
                  visible nodes/edges outside the topic view.</para> 
              </formalpara> 
            </listitem> 
          </itemizedlist> 
        </section> 
        <section> 
          <title>Map view</title> 
          <itemizedlist> 
            <listitem> 
              <formalpara> 
                <title>Hide node</title> 
                <para>The node and all its edges are removed from the visible
                  graph.</para> 
              </formalpara> 
            </listitem> 
            <listitem> 
              <formalpara> 
                <title>Hide edge</title> 
                <para>The edge is removed from the visible graph.</para> 
              </formalpara> 
            </listitem> 
            <listitem> 
              <formalpara> 
                <title>Expand node</title> 
                <para>Any of the node's edges which are in the filtered graph
                  but not in the visible graph are added, together with the nodes on the other
                  side and any edges between those nodes in the filtered graph but not in the
                  visible graph.</para> 
              </formalpara> 
            </listitem> 
            <listitem> 
              <formalpara> 
                <title>Collapse node</title> 
                <para>All nodes which only have edges to the collapsed node and
                  between each other are removed from the visible graph.</para> 
              </formalpara> 
            </listitem> 
            <listitem> 
              <formalpara> 
                <title>Set Focus Node</title> 
                <para>Whether done by double-clicking a node or setting the
                  Start Topic, moves into topic view.</para> 
              </formalpara> 
            </listitem> 
            <listitem> 
              <formalpara> 
                <title>Change locality</title> 
                <para>No effect.</para> 
              </formalpara> 
            </listitem> 
            <listitem> 
              <formalpara> 
                <title>Filter out</title> 
                <para>Any nodes and edges filtered out of the visible graph are
                  removed.</para> 
              </formalpara> 
            </listitem> 
            <listitem> 
              <formalpara> 
                <title>Filter in</title> 
                <para>New nodes and edges are added to the visible
                  graph.</para> 
              </formalpara> 
            </listitem> 
          </itemizedlist> 
        </section> 
      </section> 
      <section> 
        <title>The Properties box</title> 
        <para>The Properties box is accessed via a topic's context menu (right
          mouse click). Where applicable, it contains: 
          <itemizedlist> 
            <listitem> 
              <para>The topic's Topic Name(s);</para> 
            </listitem> 
            <listitem> 
              <para>The topic's Type(s); </para> 
            </listitem> 
            <listitem> 
              <para>The topic's Subject Indicator(s) and</para> 
            </listitem> 
            <listitem> 
              <para>The list of Occurrences associated with the topic, grouped
                by occurrence type.</para> 
            </listitem> 
          </itemizedlist></para> 
        <figure id="propertiesboxpix"> 
          <title>Properties Box</title><graphic fileref="propertiesbox.png"/> 
        </figure> 
        <para>The Properties box remains open until specifically closed. Its
          contents are updated each time a different topic's properties are
          requested.</para> 
      </section> 
    </section> 
    <section id="search01"> 
      <title>Searching in VizDesktop</title> 
      <para>The search box provides an alternative way to find topics. Enter
        all or part of a topic name in the search box. Vizigator will search the
        topic names that appear in the topic shapes. The hits will blink and the visible
        part of the topic map will be repositioned to center the hit with the highest
        relevance (i.e., closest matches).</para> 
      <para>If more than one hit is displayed, the topic type can be determined
        by right clicking on a blinking topic to a ccess its Properties box. Once the
        appropriate topic has been found, right clicking to set it as the Start Topic
        will localize a Topic View around the chosen topic.</para> 
      <para>Using the 
        <command>Clear</command> button will clear the search box, stop all
        topics from blinking, and reset the cursor within the search box.</para> 
    </section> 
    <section id="mconf"> 
      <title>Configuration</title> 
      <section id="configcomponents"> 
        <title>Components of a configuration</title> 
        <para>A configuration is defined by the current state of each of the
          items under the following menus: 
          <!-- these aren't command-line commands; menuchoice would work -->
          <itemizedlist> 
            <listitem> 
              <para><command>Filtering Topics</command>;</para> 
            </listitem> 
            <listitem> 
              <para><command>Filtering Associations</command>;</para> 
            </listitem> 
            <listitem> 
              <para><command>Styling</command>;</para> 
            </listitem> 
            <listitem> 
              <para><command>Options</command>; </para> 
            </listitem>
            <listitem> 
              <para><command>Topic Type Precedence</command>; </para> 
            </listitem> 
            <listitem> 
              <para><command>Name Scoping</command>; and</para> 
            </listitem> 
            <listitem> 
              <para> 
                <command>Association Scoping</command></para> 
            </listitem> 
          </itemizedlist></para> 
        <para>Optionally, if a Start Topic is specified, it will be saved as
          part of the configuration.</para> 
        <note> 
          <para>The locality factor is not saved as part of a configuration. If
            a topic map is opened in Topic View, it will conform to the current setting of
            the locality factor.</para> 
        </note> 
      </section> 

<section id="filtering"> 
<title>Filtering Topics and Associations</title> 

<para>The <command>Filtering Topics</command> and <command>Filtering
Associations</command> menus provide checklists for including or
excluding topic and association types to be displayed.  Unchecking the
box of a particular topic type will remove all of the topics of that
type from the visualization, as well as any associations by which they
are linked to other topics. Conversely, unchecking the box of a
particular association type will remove all of the associations of
that type and any topics that are only in the visualization because of
that association.</para>

<para>For example, assume that a topic map has both
<command>born-in</command> and <command>died-in</command>
associations, each expressing relationships between a
<command>person</command> and either a <command>city</command> or a
<command>country</command>. </para>

<para>Unchecking the topic type <command>city</command> will remove
not only all of the topics of type <command>city</command>, but also
all <command>born-in</command> and <command>died-in</command>
associations in which a <command>city</command> plays the
<command>place</command> role, but not in which a
<command>country</command> plays that role. Unchecking the
<command>born-in</command> association will remove all such
associations and topics of type either <command>city</command> or
<command>country</command> that play the <command>place</command> role
in each instance of that association (and which do not play any other
roles in that view).</para>

<para>Note that if the checkbox is shown in gray this means that the
topic or association type has no setting, and that the setting used is
that of the default topic or association type. Checkboxes shown in
green or red are set specifically for the given topic/association
type. The menu will contain an item for "Default type" which can be
used to change the default setting.</para>
</section> 

<section id="stylingtopics"> 
<title>Styling Topics and Associations</title> 

<para> The <command>Styling</command> menu consists of two items to
change the randomly pre-assigned shapes, colors, and fonts used to
designate topic and association types.</para>

<para>The <command>Styling\Styling Associations</command> and
<command>Styling\Styling Topics</command> menu items each bring up
similar dialog boxes for choosing the Shape (geometric shape, weight)
, color, and font to be used for topics or associations of a
particular type. The <command>Icon</command> portion of the
<command>Shape</command> tab can be used to stipulate an icon to
appear to the left of each topic of that type. Clicking
<command>Clear</command> will clear the field and remove the icons for
the designated type.</para>

<para>Note that a type can either have a specified setting, or it can
use the setting for the default type. The default type appears in the
list and its settings can be changed just like those of real
types. There is also a button for each type that can be used to remove
all settings so that it reverts to getting its settings from the
default type.</para>
</section> 

<section id="genoptions"> 
<title>Determining General Options</title> 
        <para>The 
          <command>Options\General</command> menu item brings up the
          multi-tabbed 
          <command>General Options</command> dialog box, which is used to set
          more general parameters: 
          <itemizedlist> 
            <listitem> 
              <para><emphasis>Interaction</emphasis> - mouse button default
                behavior is described in <xref linkend="nav"/>; this tab is used to override
                that behavior and to designate the amount of information to be displayed when
                hovering over an association.</para> 
            </listitem> 
            <listitem> 
              <para><emphasis>Background Color</emphasis> - for choosing the
                background color to be used in the visualization.</para> 
            </listitem> 
            <listitem> 
              <para><emphasis>Topic Type Exclusion</emphasis> - for choosing
                the typing topics that should not be visible. Continuing the example from
                <xref linkend="filtering"/>, unchecking the 
                <command>city</command> topic type under the 
                <command>Filtering Topics</command> menu will remove all
                instances of 
                <command>city</command>, but will not remove the 
                <command>city</command> topic itself. This dialog box can be
                used to remove the typing topic 
                <command>city</command>, regardless of whether instances of the
                topic type are also removed.</para> 
            </listitem> 
          </itemizedlist></para> 
      </section>

<section id="sect-type-precedence">
<title>Topic Type Precedence</title>

<para>
The <command>Options\Topic Type Precedence</command> menu item brings
up a simple dialog box that can be used to specify the precedence
order of topic types. This is used to determine how to render topics
which have more than one type. Topics which have more than one type
will then be rendered according to the configuration for the topic
which is comes first in the precedence order.
</para>
</section>
 
      <section id="name_scope"> 
        <title>Name Scoping</title> 
        <para>The 
          <command>Name Scoping</command> menu offers a choice of scoping
          topics available in the topic map (if any) to be applied to the Topic Names of
          all topics. Choosing a scoping topic makes that scope active. The active scope
          will be saved with a configuration.</para> 
      </section> 
      <section id="assoc_scope"> 
        <title>Association Scoping</title> 
        <para>The 
          <command>Association Scoping</command> menu offers a choice of
          scoping topics available in the topic map (if any) to be applied to the
          Association Types of all topics. </para> 
        <para>The menu is divided into two sections. The top section has three
          options: 
          <itemizedlist> 
            <listitem> 
              <para><command>Show All</command>: In this mode, the scope filter
                is off, and none of the settings in the lower part of the menu have any effect.
                All associations are shown, regardless of their scope.</para> 
            </listitem> 
            <listitem> 
              <para><command>Loose Filter</command>: In this mode, the scope
                filter is on, and all associations whose scopes contain one of the chosen
                scoping topics in the lower section will be shown.</para> 
            </listitem> 
            <listitem> 
              <para><command>Strict Filter</command>: In this mode, the scope
                filter is on, and all associations which are in the unconstrained scope or
                whose scope contain all of the chosen scoping topics will be shown.</para> 
            </listitem> 
          </itemizedlist></para> 
        <para>The lower section contains one item for every topic that occurs
          in the scope of an association in the topic map, sorted alphabetically. If the
          scoping topics are instances of more than one type (say, if some are instances
          of "language" and others of "country"), the menu will have an additional
          level.</para> 
        <para>Choosing a scoping topic makes that scope active. The active
          scope will be saved with a configuration.</para> 
      </section> 
      <section> 
        <title>Saving and using the configuration</title> 
        <para>The current state of the configuration settings can be saved
          using the 'File menu'. </para> 
        <para>When a topic map (e.g., foo.xtm) is loaded into VizDesktop, if a
          configuration file (e.g., foo.xtm.viz) exists in the same directory, it will be
          automatically loaded at the same time.</para> 
        <para>Otherwise, a topic map is loaded without a defined configuration,
          that is, all topics and associations are visible and VizDesktop uses default
          shapes and fonts, and randomly assigned colors for topic and association type
          displays.</para> 
        <note> 
          <para>In order for configuration files to properly do their job, they
            have to be able to reference topics in a topic map. There are a number of ways
            in which this can be done, some more robust than others.</para> 
          <para>The most robust method is through a subject identifier, which
            Vizigator will use if available. Where no subject identifier has been specified
            by the author of the topic map, the fallback solution is for Vizigator to use
            the item identifier, which involves pointing back into the source topic map file
            itself. What this means is that if the file is moved to another location, the
            references may break. The moral of this story is always use subject
            identifiers, especially for typing topics. </para> 
        </note> 
      </section> 
    </section> 
  </section>
 
  <section id="vl01"> 
    <title>VizLet&#x2122; - Vizigating in web applications</title> 

      <para> VizLet is an applet that provides the same visualization
        functionality as VizDesktop, except that the menu bar (and all the
        functionality available through it), is unavailable. VizLet is intended to be
        used to add visualization functionality to web applications and can be embedded
        in any web application. </para> 

    <section> 
      <title>Comparing VizLet to VizDesktop</title> 
      <para>The following restrictions apply to VizLet compared to VizDesktop: 
        <itemizedlist> 
          <listitem> 
            <para>The configuration cannot be changed. That is, filter
              settings, colors, etc., are loaded from the server and cannot be modified by
              the user.</para> 
          </listitem> 
          <listitem> 
            <para>The topic map to be vizigated is given in the settings loaded
              from the server and cannot be changed.</para> 
          </listitem> 
        </itemizedlist></para> 
      <para>The following differences apply to VizLet compared to VizDesktop: 
        <itemizedlist> 
          <listitem> 
            <para>Each time VizLet is entered, it will be: 
              <itemizedlist> 
                <listitem> 
                  <para>in Topic View;</para> 
                </listitem> 
                <listitem> 
                  <para>with locality of 1; and</para> 
                </listitem> 
                <listitem> 
                  <para>with the topic used to initiate vizigation set as the
                    Focus Node.</para> 
                </listitem> 
              </itemizedlist> </para> 
          </listitem> 
          <listitem> 
            <para>There is no Map View.</para> 
          </listitem> 
          <listitem> 
            <para>Even if a Start Topic has been specified in the
              configuration, there is no provision to access it in the VizLet
              interface.</para> 
          </listitem> 
          <listitem> 
            <para>It is possible to navigate to the Occurences listed in the
              Properties box.</para> 
          </listitem> 
          <listitem> 
            <para>A topic's context menu (right click) contains the "Go to
              Topic Page" item, supporting reverse navigation back to the text-based view of
              the topic map.</para> 
          </listitem> 
          <listitem> 
            <para> The 
              <command>Association Scoping</command> menu is available on the
              popup menu when right-clicking on the background. It will have the same
              functionality as in VizDesktop, but will only contain the topics used in the
              scope of associations in the topic map fragment held by the VizLet at that
              time.</para> 
          </listitem> 
        </itemizedlist></para> 
    </section> 
    
<section id="usevizlet"> 
<title>Using VizLet in a web application</title> 

<para>VizLet can be added to a web page by adding the following HTML
to the page:</para>
      <literallayout><![CDATA[
  <applet width="800" height="800" alt="Ontopia vizlet" 
          code="net.ontopia.topicmaps.viz.Vizlet.class"
          archive="ontopia-vizlet.jar">
    <param name="baseuri"  value="omnigator/plugins/viz/"/>
    <param name="tmid"     value="opera.ltm"/>
    <param name="idtype"   value="indicator"/>
    <param name="idvalue"  value="http://www.topicmaps.org/xtm/1.0/country.xtm#cn"/>
  </applet>
]]></literallayout> 
      <para>The applet parameters are as follows:</para> 

      <variablelist> 
        <varlistentry> 
          <term>tmrap</term> 
          <listitem> 
            <para>This is the URL on the server where the TMRAP servlet can be
              found. (More about how to set these up below.) The URL is resolved relative to
              the code base of the applet.</para> 
          </listitem> 
        </varlistentry> 
        <varlistentry> 
          <term>config</term> 
          <listitem> 
            <para>This is the URL on the server where the configuration topic
              map in XTM syntax can be found. VizLet will load it directly from this URL. The
              URL is resolved relative to the code base of the applet. If this parameter is
              omitted, VizLet will work without a configuration.</para> 
          </listitem> 
        </varlistentry> 
        <varlistentry> 
          <term>tmid</term> 
          <listitem> 
            <para>This is the ID of the topic map in the topic map
              registry.</para> 
          </listitem> 
        </varlistentry> 
        <varlistentry> 
          <term>idvalue</term> 
          <listitem> 
            <para>This is the identifying value used to look up the Focus Node
              to be loaded in VizLet. This is always a URI.</para> 
          </listitem> 
        </varlistentry> 
        <varlistentry> 
          <term>idtype</term> 
          <listitem> 
            <para>This tells VizLet what kind of identifier is contained in the
              <symbol>idvalue</symbol> parameter. The alternatives are
              <literal>"source"</literal> (meaning item identifier),
              <literal>"indicator"</literal> (meaning subject identifier), and
              <literal>"subject"</literal> (meaning subject locator).</para> 
          </listitem> 
        </varlistentry> 
        <varlistentry> 
          <term>gototarget</term> 
          <listitem> 
            <para>The name of the HTML frame in which Vizlet should open topic
              pages when the user selects the "Go to Topic Page" menu item in Vizlet.
              Defaults to the current frame if not set.</para> 
          </listitem> 
        </varlistentry> 
        <varlistentry> 
          <term>proptarget</term> 
          <listitem> 
            <para>The name of the HTML frame in which Vizlet should open URLs
              when the user selects a URL in the Properties box. Defaults to
              <literal>_blank</literal> (meaning new frame every time) if not set.</para> 
          </listitem> 
        </varlistentry> 
        <varlistentry> 
          <term>scopevalue</term> 
          <listitem> 
            <para>The identifying value used to look up the topic used for name
              scoping, identified by URI. A value set here will override a value saved in the
              Vizigator configuration.</para> 
          </listitem> 
        </varlistentry> 
        <varlistentry> 
          <term>scopetype</term> 
          <listitem> 
            <para>This tells VizLet what kind of identifier is contained in the
              <symbol>scopevalue</symbol> parameter. The alternatives are the same as for
              <symbol>idtype</symbol>.</para> 
          </listitem> 
        </varlistentry> 
        <varlistentry> 
          <term>controlsVisible</term> 
          <listitem> 
            <para>A boolean value of 'true' or 'false' that specifies whether
              the control panel should be visible or not. The default is 'true'.</para> 
          </listitem> 
        </varlistentry> 
        <varlistentry> 
          <term>lang</term> 
          <listitem> 
            <para>Specifies the language that is to be used in the user
              interface. The default is 'en' (English). See <xref linkend="scope"/> for the
              currently supported languages.</para> 
          </listitem> 
        </varlistentry> 
  <varlistentry>
    <term>menufile</term>
    <listitem>
      <para>Specifies the location of a file which describes which menu
      items in popup menus are to be enabled or disabled. The value is a
      URI relative to the URI the applet was loaded from. For more
      detail, see <xref linkend="sect-menufile"/>.</para>
    </listitem>
  </varlistentry>
  <varlistentry>
    <term>locality</term>
    <listitem>
      <para>The locality setting VizLet starts with on loading. The
      default is 1.</para>
    </listitem>
  </varlistentry>
  <varlistentry>
    <term>max-locality</term>
    <listitem>
      <para>The largest locality value which VizLet will accept. The
      default is 5.</para>
    </listitem>
  </varlistentry>
  <varlistentry>
    <term>wallpaper_image</term>
    <listitem>
      <para>A URL pointing to an image to be used as a wallpaper
      background in the Vizlet. If no URL is provided, no background
      will be shown.</para>     
    </listitem>
  </varlistentry>
</variablelist> 

<para>In order for this to work, a number of things need to be set up
on the server side, and we will walk through them one by one. One
example of how this can be done can be found in VizPlugin for
Omnigator; looking at its source code may be instructive.</para>

<para>The first step is to make the
<filename>${OKS_HOME}/extras/ontopia-vizlet.jar</filename> file available on the server
side. Put it anywhere you want, then make the <symbol>applet</symbol>
element refer to it. Use the Java console of your web browser to check
whether you have succeeded or not. For more information consult <ulink
url="http://www.w3.org/TR/html401/struct/objects.html#h-13.4">the HTML
4.01 Recommendation</ulink>.</para>
      <para>The next step is to set up the TMRAP (topic map remote access
        protocol) servlet used by the applet to download topic map fragments for the
        visualization. This is done by adding the following to the
        <filename>web.xml</filename> file of the web application:</para> 
      <literallayout><![CDATA[
  <servlet>
    <servlet-name>TMRAPServlet</servlet-name>
    <servlet-class>
      net.ontopia.topicmaps.utils.tmrap.RAPServlet
    </servlet-class>
    <init-param>
      <param-name>view_uri</param-name>
      <param-value>http://localhost:8080/omnigator/models/topic_complete.jsp?tm=%tmid%&amp;id=%topicid%</param-value>
    </init-param>
    <init-param>
      <param-name>edit_uri</param-name>
      <param-value>http://localhost:8080/ontopoly/enter.ted?tm=%tmid%&amp;id=%topicid%</param-value>
    </init-param>
  </servlet>

  <servlet-mapping>
    <servlet-name>TMRAPServlet</servlet-name>
    <url-pattern>/plugins/viz/xtm-fragment</url-pattern>
  </servlet-mapping>
  <servlet-mapping>
    <servlet-name>TMRAPServlet</servlet-name>
    <url-pattern>/plugins/viz/topic-page</url-pattern>
  </servlet-mapping>
]]></literallayout> 
      <para>The <symbol>url-pattern</symbol> parameter must match what is given
        in the <symbol>tmrap</symbol> parameter to the applet, so that the servlet is
        made available where the applet expects to find it. Also, the
        <symbol>uri</symbol> parameter to the servlet must be a URI template where once
        the topic map ID and topic ID are filled in, the main page for the topic can be
        found. VizLet will go to this URI when the "Go to Topic Page" option is
        selected in VizLet.</para> 
      <para>The final part is to place the configuration XTM file somewhere on
        the server so that VizLet can download it. This must be in the location that
        the <symbol>config</symbol> parameter refers to. VizPlugin uses a JSP file to
        do this, because it needs to be able to support multiple configurations, but if
        you only have a single configuration file you can just refer to it directly and
        store it on the server as a normal file.</para> 
      <para>If you experience unexpected results with VizLet, please do the
        following: 
        <itemizedlist> 
          <listitem> 
            <para>empty the browser cache, restart the brower, and try again,
              to make sure you have the latest version of the VizLet;</para> 
          </listitem> 
          <listitem> 
            <para>check the Java Console, as the VizLet will print its version
              number and build number there; and </para> 
          </listitem> 
          <listitem> 
            <para>check the Java Console for exceptions, which we would very
              much like to see in any bug reports.</para> 
          </listitem> 
        </itemizedlist></para> 


<section id="sect-menufile">
<title>The <symbol>menufile</symbol> parameter</title>

<para>
As stated above, this parameter specifies the location of a file which
describes which menu items in popup menus should be visible. The menu
file is a normal text file, of which an example can be seen below:
</para>

<literallayout>expand.node=on
collapse.node=on
hide.node=on
hide.edge=on
sticky=on
properties=off       # users never use this, anyway
set.start.topic=on
go.to.topic.page=off # we don't have topic pages
search.bar=off
</literallayout>

<para>
Menu items that are not mentioned in the file will be displayed (and
if the parameter is not given all items are displayed). The list of
menu choice names is:
</para>

<informaltable>
<tgroup cols="2">
<tbody>
<row><entry>expand.node</entry> <entry>Expand node</entry></row>
<row><entry>collapse.node</entry> <entry>Collapse node</entry></row>
<row><entry>hide.node</entry> <entry>Hide node</entry></row>
<row><entry>hide.edge</entry> <entry>Hide edge</entry></row>
<row><entry>sticky</entry> <entry>Sticky</entry></row>
<row><entry>properties</entry> <entry>Properties</entry></row>
<row><entry>set.start.topic</entry> <entry>Set start topic</entry></row>
<row><entry>copy.name</entry> <entry>Copy name</entry></row>
<row><entry>go.to.topic.page</entry> <entry>Go to topic page</entry></row>
<row><entry>show.search.bar</entry>
     <entry>Show search bar</entry></row>
<row><entry>toggle.controls</entry>
     <entry>Toggle controls</entry></row>
<row><entry>set.all.nodes.sticky</entry>
     <entry>Set all nodes sticky</entry></row>
<row><entry>set.all.nodes.unsticky</entry>
     <entry>Set all nodes unsticky</entry></row>
<row><entry>stop.moving.nodes</entry>
     <entry>Stop moving nodes</entry></row>
<row><entry>enable.motion.killer</entry>
     <entry>Start/stop motion reduction</entry></row>
<row><entry>undo</entry>
     <entry>Undo</entry></row>
<row><entry>redo</entry>
     <entry>Redo</entry></row>
<row><entry>enable.neighbour.circle</entry>
     <entry>Enable neighbour circle</entry></row>
<row><entry>topic.styles</entry>
     <entry>Topic type configuration</entry></row>
<row><entry>association.styles</entry>
     <entry>Association type configuration</entry></row>
</tbody>
</tgroup>  
</informaltable>
</section>
</section> 

<section id="sect-copy-name">
<title>The "Copy name" operation</title>

<para>
In VizDesktop the popup menu on topic nodes contains a "Copy name"
choice, which copies the name of the node to the system clipboard.
This menu choice is by default not present in VizLet because for
security reasons applets do not have access to the clipboard.
(Otherwise, web pages would be able to spy on your clipboard, or spam
it with unwelcome content.)
</para>

<para>
To solve this, there is another version of the VizLet in the
<filename>${OKS_HOME}/extras/signed-vizlet.jar</filename> file, which is
cryptographically signed. This gives the VizLet access to the
clipboard, provided users accept the certificate with which it was
signed. In order to avoid bothering users with certificates the
VizPlugin (see <xref linkend="vp01"/>) does not use the signed applet.
</para>

<para>
Using the signed applet is not in itself enough to enable the "Copy
name" menu item. To do this, use the <symbol>menufile</symbol>
parameter to VizLet as described in <xref linkend="sect-menufile"/>.
</para>
</section>
</section>
 
  <section id="vp01"> 
    <title>VizPlugin&#x2122; - Vizigating in Omnigator</title> 

      <para> VizPlugin is an Omnigator plug-in that adds support for graphic
        visual navigation of topic maps. It uses VizLet (described in
        <xref linkend="vl01"/>) to support visualization directly in the browser. Like
        the other plug-ins, it appears as a button (<firstterm>Vizigate</firstterm>) in
        the row of links at the top of Omnigator topic pages. </para> 

      <para>All of the restrictions and differences that apply to VizLet, when
        compared to VizDesktop, also apply to VizPlugin.</para> 

    <section> 
      <title>Using VizPlugin</title> 
      <para>To use VizPlugin, click on the 
        <command>Vizigate</command> link, and the current topic will be loaded
        into VizLet and displayed. To return to the Omnigator view, right click on the
        topic to be viewed in Omnigator and choose the additional menu item available ,
        <firstterm>Go to Topic Page</firstterm>. </para> 
      <note> 
        <para>For this to work, support for Java applets must be turned on in
          your browser, and it must also support Swing applets.</para> 
      </note> 
      <figure id="vizpluginpix"> 
        <title> VizPlugin is VizLet as used in the Omnigator</title><graphic
        fileref="vizplugin.png"/> 
      </figure> 
      <para> VizPlugin will work for any topic map, regardless of whether a
        configuration has been created for it or not, but results are more likely to be
        more consistent if a configuration exists.</para> 
    </section> 
  </section> 
</article> 
